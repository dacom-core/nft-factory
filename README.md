# NFT
### Стек: C/C++, eosio.cdt 1.7.0

# Введение
Контракт предоставляет сервис выпуска, покупки и продажи NFT с возможностью физической поставки. 

# Компиляция
Заменить ABSOLUTE_PATH_TO_CONTRACT на абсолютный путь к директории контракта NFT. 
```
docker run --rm --name eosio.cdt_v1.7.0 --volume /ABSOLUTE_PATH_TO_CONTRACT:/project -w /project eostudio/eosio.cdt:v1.7.0 /bin/bash -c "eosio-cpp -abigen -I include -R include -contract nft -o nft.wasm nft.cpp" &
```


# Генерация документации
Требуется Doxygen версии от 1.9.3
```
git submodule update --init --recursive
doxygen
```


# Установка
```
cleos set contract nft ABSOLUTE_PATH_TO_CONTRACT -p nft
```


# Действующие аккаунты
me - собственное имя контракта;


# Роли

# Сценарии
### Пополнение баланса
Для покупки NFT необходимо пополнить баланс в контракте. Для этого, необходимо осуществить перевод токенов на аккаунт контракта. В этот момент, контракт автоматически создаст запись в базе с балансом токенов и их контрактом. Обычно действие перевода токенов на контракт находится в одной транзакции с действием на оформление покупки. 

### Выпуск NFT
Выпуск NFT осуществляется создателем с уникальным ID. До поступления NFT в продажу, NFT хранится в области оперативной памяти создателя под его управлением. Создатель указывает базовую стоимость целой NFT при её создании. Создатель может указать, может ли он или будущие владельцы выпускать дополнительные части NFT или делить её на части.

Cоздадим объект NFT с одной частью:
```
cleos push action nft create '[creator, ru, "первая NFT", "описание волшебной NFT", 1, realty, "json_links_to_images", "link to ipns, if use", false, ""]' -p creator
```


Cоздадим объект NFT со множеством частей:
```
cleos push action nft create '[creator, ru, "первая NFT", "описание волшебной NFT", 26, realty, "json_links_to_images", "link to ipns, if use", false, ""]' -p creator
```
Все части появляются на балансе создателя в тот же момент. 

Вызовом действия create мы создадим объект NFT с одной частью. 

Для проверки получим таблицу objects(nft, nft). 

### Редактирование NFT
Запрет на эмиссию и деление NFT не может быть снят, если он установлен создателем. Владельцы могут запретить деление и эмиссию, если она разрешена создателем. Новые владельцы не могут разрешить деление и эмиссию, если она была запрещена предыдущими владельцами. 

### Продажа NFT
После создания, любую NFT можно продать. Для этого, необходимо вызвать метод sell: 

Продадим одну-единственную часть созданной NFT за 10 токенов SET без возможности торгов, но с физической поставкой методом самовывоза: 
```
cleos push action nft sell '[creator, 1, 1, "eosio.token", "10.0000 SET", false, true, "Alanya, Turkey", [selfdelivery], [], ""]' -p creator
```

Для проверки получим таблицу markets(nft, nft). 


### Покупка NFT
Создадим запрос на покупку выставленной на продажу части: 
```
cleos push action nft buy '[buyer, 1, ru, 1, "10.0000 SET", "доставить сюда", "selfdelivery", "", ""]' -p buyer
```

### Доставка NFT
Если NFT требует доставки, то перед тем, как принять заказ в работу, продавец должен убедиться в том, что покупатель поставил всю необходимую информацию. Если всё верно, вызвать метод:

```
cleos push action nft acceptreq '[creator, 1]' -p creator
```
После чего, подтвердить факт осуществления доставки с помощью вызова метода:
```
cleos push action nft setdelstatus '[creator, 1, finish]' -p creator
```
Заказ, при этом, будет помечен как исполненный, а NFT передана покупателю. 

### Торги за NFT
Если на рынке предусмотрена возможность торгов, то каждый потенциальный покупатель может предложить свою цену. Если цена устраивает продавца, то он может утвердить сделку методом:
```
cleos push action nft acceptreq '[creator, 1]' -p creator
```

### Эмиссия NFT
Эмиссия NFT происходит с помощью вызова метода emit создателем NFT или членом белого листа: 
```
cleos push action nft emit '[creator, 2, 100]' -p creator
```
Здесь создатель выпускает для объекта с идентификатором 2 - 100 частей. 

### Удаление NFT
Если объект создан, но никогда не был продан, то его можно удалить с помощью метода:
```
cleos push action nft remove '[creator, 3]' -p creator
```
Здесь мы удаляем объект с иденификатором 3

### Отзывы на NFT
После завершения сделки, покупатель может создать отзыв: 
```
cleos push action nft setreview '[buyer, 2, "message in review", 5, ""]' -p buyer
```
Здесь покупатель оставляет отзыв для объекта с идентификатором 2 и оценкой 5 (оценки принимаются от 0 до 5)

### Сообщения в NFT
В процессе обмена, покупатель и продавец могут обмениваться сообщениями, для этого:
```
cleos push action nft sendmessage '[usermame, 4, ru, "this is message"]' -p username
```
Где username - это buyer или seller


### Аукцион NFT
TODO | задание на хакатон | все необходимые структуры данных есть


## Документация к методам и таблицам контракта
Документация к методам и таблицам контракта доступна в папке docs/html/index.html

